webpackJsonp([10],{"1NHb":function(e,t,n){var o=n("iIir");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);n("8bSs")("a3180a38",o,!0)},iIir:function(e,t,n){(e.exports=n("BkJT")(!1)).push([e.i,"\n.tab-container[data-v-40a9f71c]{\n    margin: 30px;\n}\n",""])},r27l:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("ZLEe"),l=n.n(o),r=n("T452");var a=n("KC6+"),i=n("TIfe"),s={components:{},data:function(){return{inventory_list:[],inventory_row:{},inventoryForm:{name:"",origin:"",category:"",description:"",unit:"",balance:0,benefitRate:0,fileList:[]},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],origin:[{required:!0,message:"请输入原产地",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],category:[{required:!0,message:"请选择一个类目",trigger:"change"}],description:[{required:!0,message:"请填写产品介绍",trigger:"blur"}],unit:[{required:!0,message:"请输入单位",trigger:"blur"}],balance:[{required:!0,message:"请输入一个数值",trigger:"blur"}]},search:"",dialogVisible:!1,thumbs:[],uploadUrl:r.a.host+"/weapp/upload"}},beforeCreate:function(){},created:function(){var e=this,t=r.a.getAsteroid(),n=Object(i.a)()._id;t.subscribe("inventories.all",n),console.log("sub id: "+t.subscribe("inventories.all",n).id),t.ddp.on("added",function(t){t.collection;var n=t.id,o=t.fields;console.log("added"),console.log(o),e.inventory_list.includes(function(e){e.id})||(o.id=n,e.inventory_list.push(o))}),t.ddp.on("changed",function(t){t.collection;var n=t.id,o=t.fields;console.log("changed"),console.log(o);var r=e.inventory_list.findIndex(function(e){return e.id==n});if(console.log(r),r>=0){o.id=n;var a=e.inventory_list[r];for(var i in l()(o))a[""+i]=o[""+i]}}),t.ddp.on("removed",function(t){t.collection;var n=t.id;console.log("removed"),e.inventory_list=e.inventory_list.filter(function(e){return e.id!==n})})},beforeMount:function(){},mounted:function(){},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return Object(a.a)("商品信息填写不合格","error"),!1;var n;t.inventoryForm.platform_id=Object(i.a)()._id,(n=t.inventoryForm,r.a.getAsteroid().call("inventories.add",n)).then(function(e){0===e.code&&(Object(a.a)("商品添加成功","success"),t.resetForm("inventoryForm"),t.inventoryForm.fileList=[],t.thumbs=[]),-1===e.code&&Object(a.a)("商品添加失败","error")})})},resetForm:function(e){this.$refs[e].resetFields()},handleClick:function(e){this.inventory_row=e,this.dialogVisible=!0},handleUpdate:function(){var e,t=this;(e=this.inventory_row,r.a.getAsteroid().call("inventories.update",e)).then(function(e){0===e.code&&(Object(a.a)("商品修改成功","success"),t.inventory_row={},t.dialogVisible=!1),-1===e.code&&Object(a.a)("商品修改失败","error")})},handleDelete:function(e,t){(function(e){return r.a.getAsteroid().call("inventories.remove",e)})(t.id).then(function(e){0===e.code&&Object(a.a)("商品删除成功","success"),-1===e.code&&Object(a.a)("商品删除失败","error")})},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},handleRemove:function(e,t){},handlePreview:function(e){},handleThumbSuccess:function(e){var t="http://"+e.data.url,n={name:e.data.name,url:t,type:"thumb"};this.inventoryForm.fileList.push(n),this.thumbs.push(n)}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-form",{ref:"inventoryForm",staticClass:"demo-ruleForm",attrs:{model:e.inventoryForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[n("el-input",{model:{value:e.inventoryForm.name,callback:function(t){e.$set(e.inventoryForm,"name",t)},expression:"inventoryForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"原产地",prop:"origin"}},[n("el-input",{model:{value:e.inventoryForm.origin,callback:function(t){e.$set(e.inventoryForm,"origin",t)},expression:"inventoryForm.origin"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"类目",prop:"category"}},[n("el-select",{attrs:{placeholder:"请选择一个类目"},model:{value:e.inventoryForm.category,callback:function(t){e.$set(e.inventoryForm,"category",t)},expression:"inventoryForm.category"}},[n("el-option",{attrs:{label:"新鲜蔬菜",value:"新鲜蔬菜"}}),e._v(" "),n("el-option",{attrs:{label:"肉禽蛋品",value:"肉禽蛋品"}}),e._v(" "),n("el-option",{attrs:{label:"精品水果",value:"精品水果"}}),e._v(" "),n("el-option",{attrs:{label:"速冻食品",value:"速冻食品"}}),e._v(" "),n("el-option",{attrs:{label:"酒水冲调",value:"酒水冲调"}}),e._v(" "),n("el-option",{attrs:{label:"休闲食品",value:"休闲食品"}}),e._v(" "),n("el-option",{attrs:{label:"粮油副食",value:"粮油副食"}}),e._v(" "),n("el-option",{attrs:{label:"海鲜水产",value:"海鲜水产"}}),e._v(" "),n("el-option",{attrs:{label:"其他种类",value:"其他种类"}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"产品介绍",prop:"description"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.inventoryForm.description,callback:function(t){e.$set(e.inventoryForm,"description",t)},expression:"inventoryForm.description"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"单位",prop:"unit"}},[n("el-input",{model:{value:e.inventoryForm.unit,callback:function(t){e.$set(e.inventoryForm,"unit",t)},expression:"inventoryForm.unit"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"库存量",prop:"balance"}},[n("el-input",{attrs:{type:"number"},model:{value:e.inventoryForm.balance,callback:function(t){e.$set(e.inventoryForm,"balance",t)},expression:"inventoryForm.balance"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"佣金比例",prop:"benefitRate"}},[n("el-select",{attrs:{placeholder:"请选择佣金比"},model:{value:e.inventoryForm.benefitRate,callback:function(t){e.$set(e.inventoryForm,"benefitRate",t)},expression:"inventoryForm.benefitRate"}},[n("el-option",{attrs:{label:"10%",value:"0.10"}}),e._v(" "),n("el-option",{attrs:{label:"11%",value:"0.11"}}),e._v(" "),n("el-option",{attrs:{label:"12%",value:"0.12"}}),e._v(" "),n("el-option",{attrs:{label:"13%",value:"0.13"}}),e._v(" "),n("el-option",{attrs:{label:"14%",value:"0.14"}}),e._v(" "),n("el-option",{attrs:{label:"15%",value:"0.15"}}),e._v(" "),n("el-option",{attrs:{label:"16%",value:"0.16"}}),e._v(" "),n("el-option",{attrs:{label:"17%",value:"0.17"}}),e._v(" "),n("el-option",{attrs:{label:"18%",value:"0.18"}}),e._v(" "),n("el-option",{attrs:{label:"19%",value:"0.19"}}),e._v(" "),n("el-option",{attrs:{label:"20%",value:"0.20"}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"产品头像图片",prop:"thumb"}},[n("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadUrl,"auto-upload":!0,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.handleThumbSuccess,"file-list":e.thumbs,"list-type":"picture"}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("inventoryForm")}}},[e._v("立即创建")]),e._v(" "),n("el-button",{on:{click:function(t){e.resetForm("inventoryForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),n("el-col",{attrs:{span:14,offset:2}},[n("el-row",{staticClass:"filter-container",attrs:{gutter:20}},[n("el-col",{attrs:{span:14}},[n("el-input",{attrs:{placeholder:"输入商品名称进行搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),n("el-col",{attrs:{span:10}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"}},[e._v("搜索")])],1)],1),e._v(" "),n("el-row",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.inventory_list,stripe:"",border:"","max-height":"500"}},[n("el-table-column",{attrs:{fixed:"",prop:"name",label:"商品名称",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.name)+"\n                    ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"origin",label:"原产地",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.origin)+"\n                    ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"category",label:"类目",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.category)+"\n                    ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"description",label:"产品介绍",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.description)+"\n                    ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"unit",label:"单位",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.unit)+"\n                    ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"balance",label:"库存量",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.balance)+"\n                    ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.handleClick(t.row)}}},[e._v("编辑\n                        ")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){e.handleDelete(t.$index,t.row)}}},[e._v("删除\n                        ")])]}}])})],1)],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"修改商品",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdate}},[e._v("确 定")])],1),e._v(" "),n("el-form",{ref:"inventory_row",staticClass:"demo-ruleForm",attrs:{model:e.inventory_row,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[n("el-input",{model:{value:e.inventory_row.name,callback:function(t){e.$set(e.inventory_row,"name",t)},expression:"inventory_row.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"原产地",prop:"origin"}},[n("el-input",{model:{value:e.inventory_row.origin,callback:function(t){e.$set(e.inventory_row,"origin",t)},expression:"inventory_row.origin"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"类目",prop:"category"}},[n("el-select",{attrs:{placeholder:"请选择一个类目"},model:{value:e.inventory_row.category,callback:function(t){e.$set(e.inventory_row,"category",t)},expression:"inventory_row.category"}},[n("el-option",{attrs:{label:"新鲜蔬菜",value:"新鲜蔬菜"}}),e._v(" "),n("el-option",{attrs:{label:"肉禽蛋品",value:"肉禽蛋品"}}),e._v(" "),n("el-option",{attrs:{label:"精品水果",value:"精品水果"}}),e._v(" "),n("el-option",{attrs:{label:"速冻食品",value:"速冻食品"}}),e._v(" "),n("el-option",{attrs:{label:"酒水冲调",value:"酒水冲调"}}),e._v(" "),n("el-option",{attrs:{label:"休闲食品",value:"休闲食品"}}),e._v(" "),n("el-option",{attrs:{label:"粮油副食",value:"粮油副食"}}),e._v(" "),n("el-option",{attrs:{label:"海鲜水产",value:"海鲜水产"}}),e._v(" "),n("el-option",{attrs:{label:"其他种类",value:"其他种类"}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"产品介绍",prop:"description"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.inventory_row.description,callback:function(t){e.$set(e.inventory_row,"description",t)},expression:"inventory_row.description"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"单位",prop:"unit"}},[n("el-input",{model:{value:e.inventory_row.unit,callback:function(t){e.$set(e.inventory_row,"unit",t)},expression:"inventory_row.unit"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"库存量",prop:"balance"}},[n("el-input",{attrs:{type:"number"},model:{value:e.inventory_row.balance,callback:function(t){e.$set(e.inventory_row,"balance",t)},expression:"inventory_row.balance"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"佣金比例",prop:"benefitRate"}},[n("el-select",{attrs:{placeholder:"请选择佣金比"},model:{value:e.inventory_row.benefitRate,callback:function(t){e.$set(e.inventory_row,"benefitRate",t)},expression:"inventory_row.benefitRate"}},[n("el-option",{attrs:{label:"10%",value:"0.10"}}),e._v(" "),n("el-option",{attrs:{label:"15%",value:"0.15"}})],1)],1)],1)],1)],1)},staticRenderFns:[]},u={data:function(){return{activeName:"first"}},components:{InventorySetting:n("vSla")(s,c,!1,null,null,null).exports},methods:{handleClick:function(e,t){console.log(e,t)}}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container tab-container"},[n("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"库存管理",name:"first"}},[n("inventory-setting")],1),e._v(" "),n("el-tab-pane",{attrs:{label:"近期开放",name:"second"}},[e._v("近期开放")]),e._v(" "),n("el-tab-pane",{attrs:{label:"近期开放",name:"third"}},[e._v("近期开放")]),e._v(" "),n("el-tab-pane",{attrs:{label:"近期开放",name:"fourth"}},[e._v("近期开放")])],1)],1)},staticRenderFns:[]};var p=n("vSla")(u,v,!1,function(e){n("1NHb")},"data-v-40a9f71c",null);t.default=p.exports}});