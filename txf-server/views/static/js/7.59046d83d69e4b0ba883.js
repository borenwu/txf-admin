webpackJsonp([7],{"A/pQ":function(e,t,i){(e.exports=i("BkJT")(!1)).push([e.i,"\n.tab-container[data-v-685d8060]{\n    margin: 30px;\n}\n",""])},KDOB:function(e,t,i){var l=i("v96D");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);i("8bSs")("042b8a22",l,!0)},RL2h:function(e,t,i){var l=i("A/pQ");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);i("8bSs")("2f148bdf",l,!0)},s3cx:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i("ZLEe"),n=i.n(l),r=i("T452");var o=i("KC6+"),a=i("TIfe"),s={components:{},data:function(){return{inventory_list:[],selectedInventory:{},item_row:{},itemForm:{title:"",description:"",market_price:0,sale_price:0,unit:"",spec:"",open_date:"",close_date:"",fileList:[]},item_list:[],uploadUrl:r.a.host+"/weapp/upload",image_list:[],images:[],date_range:"",rules:{description:[{required:!0,message:"请填写订单描述",trigger:"blur"}],balance:[{required:!0,message:"请输入一个数值",trigger:"blur"}],sale_price:[{required:!0}]},search:"",dialogVisible:!1,titles:["备选社区","选中社区"],communities:[],community_names:[],community_data:[],checkList:[],checkAll:!1,isIndeterminate:!0}},created:function(){var e=this,t=r.a.getAsteroid(),i=Object(a.a)()._id;t.subscribe("items.all",i),t.ddp.on("added",function(t){t.collection;var i=t.id,l=t.fields;e.item_list.includes(function(e){e.id})||(l.id=i,e.item_list.push(l))}),t.ddp.on("changed",function(t){t.collection;var i=t.id,l=t.fields,r=e.item_list.findIndex(function(e){return e.id==i});if(console.log(r),r>=0){l.id=i;var o=e.item_list[r];for(var a in n()(l))o[""+a]=l[""+a]}}),t.ddp.on("removed",function(t){t.collection;var i=t.id;e.item_list=e.item_list.filter(function(e){return e.id!==i})}),function(e){return r.a.getAsteroid().call("getInventoryList",e)}(i).then(function(t){console.log(t),0===t.code&&(e.inventory_list=t.list)}),function(e){return r.a.getAsteroid().call("getCommunityList",e)}(i).then(function(t){if(console.log(t),0===t.code){var i=t.list;e.communities=i,e.communities.forEach(function(t){return e.community_names.push(t.community_name)})}})},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return Object(o.a)("商品信息填写不合格","error"),!1;t.itemForm.inventory_id=t.selectedInventory._id,t.itemForm.inventory_name=t.selectedInventory.name,t.itemForm.inventory_description=t.selectedInventory.description,t.itemForm.inventory_thumbs=t.selectedInventory.fileList,t.itemForm.platform_id=Object(a.a)()._id,t.itemForm.unit=t.selectedInventory.unit,t.itemForm.open_date=t.date_range[0],t.itemForm.close_date=t.date_range[1];for(var i=0;i<t.checkList.length;i++)for(var l=0;l<t.communities.length;l++)t.checkList[i]==t.communities[l].community_name&&t.community_data.push(t.communities[l]);var n;t.itemForm.communities=t.community_data,console.log(t.itemForm),(n=t.itemForm,r.a.getAsteroid().call("items.add",n)).then(function(e){0===e.code&&(Object(o.a)("商品添加成功","success"),t.resetForm("itemForm"),t.itemForm.fileList=[],t.images=[],t.community_data=[],t.checkList=[]),-1===e.code&&Object(o.a)("商品添加失败","error")})})},resetForm:function(e){this.$refs[e].resetFields()},handleCheckAllChange:function(e){this.checkList=e?this.community_names:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(e){var t=e.length;this.checkAll=t===this.community_names.length,this.isIndeterminate=t>0&&t<this.community_names.length},handleClick:function(e){this.item_row=e,this.dialogVisible=!0,this.image_list=this.item_row.fileList},handleDelete:function(e,t){(function(e){return r.a.getAsteroid().call("items.remove",e)})(t.id).then(function(e){0===e.code&&Object(o.a)("商品删除成功","success"),-1===e.code&&Object(o.a)("商品删除失败","error")})},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){},handleImageSuccess:function(e){var t="http://"+e.data.url,i={name:e.data.name,url:t,type:"image"};this.itemForm.fileList.push(i),this.images.push(i)}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{lg:12}},[i("el-form",{ref:"itemForm",staticClass:"demo-ruleForm",attrs:{model:e.itemForm,rules:e.rules,"label-width":"100px"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"必选",placement:"bottom"}},[i("el-form-item",{attrs:{label:"商品"}},[i("el-select",{attrs:{"value-key":"_id",placeholder:"请选择"},model:{value:e.selectedInventory,callback:function(t){e.selectedInventory=t},expression:"selectedInventory"}},e._l(e.inventory_list,function(e){return i("el-option",{key:e._id,attrs:{label:e.description,value:e}})}))],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"订单标题",prop:"title"}},[i("el-input",{model:{value:e.itemForm.title,callback:function(t){e.$set(e.itemForm,"title",t)},expression:"itemForm.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"订单描述",prop:"description"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.itemForm.description,callback:function(t){e.$set(e.itemForm,"description",t)},expression:"itemForm.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"市场价",prop:"market_price"}},[i("el-input",{attrs:{type:"number"},model:{value:e.itemForm.market_price,callback:function(t){e.$set(e.itemForm,"market_price",t)},expression:"itemForm.market_price"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"促销价",prop:"sale_price"}},[i("el-input",{attrs:{type:"number"},model:{value:e.itemForm.sale_price,callback:function(t){e.$set(e.itemForm,"sale_price",t)},expression:"itemForm.sale_price"}})],1),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"商品单位",placement:"bottom"}},[i("el-form-item",{attrs:{label:"单位",prop:"unit"}},[i("el-input",{model:{value:e.selectedInventory.unit,callback:function(t){e.$set(e.selectedInventory,"unit",t)},expression:"selectedInventory.unit"}})],1)],1),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"如果产品需要重新包装，请填写详细规格",placement:"bottom"}},[i("el-form-item",{attrs:{label:"规格",prop:"spec"}},[i("el-input",{model:{value:e.itemForm.spec,callback:function(t){e.$set(e.itemForm,"spec",t)},expression:"itemForm.spec"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"拼团素材图片",prob:"images"}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadUrl,"auto-upload":!0,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.handleImageSuccess,"file-list":e.images,"list-type":"picture"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"拼团促销日期"}},[i("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.date_range,callback:function(t){e.date_range=t},expression:"date_range"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"拼团促销社区"}},[i("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),i("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),i("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.community_names,function(t){return i("el-checkbox",{key:t,attrs:{label:t,border:""},on:{change:e.handleCheckedCitiesChange}},[e._v("\n                        "+e._s(t)+"\n                    ")])}))],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("itemForm")}}},[e._v("立即创建")]),e._v(" "),i("el-button",{on:{click:function(t){e.resetForm("itemForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),i("el-col",{attrs:{lg:12}},[i("el-row",{staticClass:"filter-container",attrs:{gutter:20}},[i("el-col",{attrs:{span:14}},[i("el-input",{attrs:{placeholder:"输入商品名称进行搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),i("el-col",{attrs:{span:10}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"}},[e._v("搜索")])],1)],1),e._v(" "),i("el-row",[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.item_list,stripe:"",border:"","max-height":"500"}},[i("el-table-column",{attrs:{fixed:"",prop:"title",label:"订单标题",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.title)+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"market_price",label:"市场价",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.market_price)+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"sale_price",label:"促销价",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.sale_price)+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"unit",label:"单位",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.unit)+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"spec",label:"规格",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.spec)+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"open_date",label:"开始日期",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.open_date)+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"close_date",label:"结束日期",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.close_date)+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.handleClick(t.row)}}},[e._v("详情\n                        ")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.handleDelete(t.$index,t.row)}}},[e._v("删除\n                        ")])]}}])})],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"拼团详情",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1),e._v(" "),i("el-form",{ref:"item_row",staticClass:"demo-ruleForm",attrs:{model:e.item_row,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"订单标题",prop:"title"}},[i("el-input",{attrs:{readonly:"readonly"},model:{value:e.item_row.title,callback:function(t){e.$set(e.item_row,"title",t)},expression:"item_row.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"订单描述",prop:"description"}},[i("el-input",{attrs:{type:"textarea",readonly:"readonly"},model:{value:e.item_row.description,callback:function(t){e.$set(e.item_row,"description",t)},expression:"item_row.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"市场价",prop:"market_price"}},[i("el-input",{attrs:{type:"number",readonly:"readonly"},model:{value:e.item_row.market_price,callback:function(t){e.$set(e.item_row,"market_price",t)},expression:"item_row.market_price"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"促销价",prop:"sale_price"}},[i("el-input",{attrs:{type:"number",readonly:"readonly"},model:{value:e.item_row.sale_price,callback:function(t){e.$set(e.item_row,"sale_price",t)},expression:"item_row.sale_price"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"单位",prop:"unit"}},[i("el-input",{attrs:{readonly:"readonly"},model:{value:e.item_row.unit,callback:function(t){e.$set(e.item_row,"unit",t)},expression:"item_row.unit"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"规格",prop:"spec"}},[i("el-input",{attrs:{readonly:"readonly"},model:{value:e.item_row.spec,callback:function(t){e.$set(e.item_row,"spec",t)},expression:"item_row.spec"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"拼团素材"}},[i("el-carousel",{attrs:{trigger:"click",height:"150px"}},e._l(e.image_list,function(e){return i("el-carousel-item",{key:e.id},[i("img",{attrs:{src:e.url,alt:""}})])}))],1)],1)],1)],1)},staticRenderFns:[]};var m={data:function(){return{activeName:"first"}},components:{CreateItem:i("vSla")(s,c,!1,function(e){i("KDOB")},null,null).exports},methods:{handleClick:function(e,t){console.log(e,t)}}},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container tab-container"},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"新品上架",name:"first"}},[i("create-item")],1),e._v(" "),i("el-tab-pane",{attrs:{label:"近期开放",name:"second"}},[e._v("近期开放")]),e._v(" "),i("el-tab-pane",{attrs:{label:"近期开放",name:"third"}},[e._v("近期开放")]),e._v(" "),i("el-tab-pane",{attrs:{label:"近期开放",name:"fourth"}},[e._v("近期开放")])],1)],1)},staticRenderFns:[]};var d=i("vSla")(m,u,!1,function(e){i("RL2h")},"data-v-685d8060",null);t.default=d.exports},v96D:function(e,t,i){(e.exports=i("BkJT")(!1)).push([e.i,"\nimg {\r\n  width: auto;\r\n  height: auto;\r\n  max-width: 100%;\r\n  max-height: 100%;\n}\r\n",""])}});